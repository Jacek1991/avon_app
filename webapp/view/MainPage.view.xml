<mvc:View
	controllerName="Avon.controller.MainPage"
	displayBlock="true"
	xmlns="sap.m"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:unified="sap.ui.unified"
	xmlns:core="sap.ui.core"
	xmlns:layout="sap.ui.layout"
	xmlns:dnd="sap.ui.core.dnd">
	<Page busy="{viewModel>/busy}">
	<customHeader>
	<Bar>
		<contentLeft>
			<Title text="Zmiana katalogu" />
		</contentLeft>
		<contentRight>
			<Avatar src="sap-icon://customer" class="sapUiTinyMarginEnd" />
			<Title text="{auth>/username}" class="sapUiTinyMarginEnd" />
		</contentRight>
	</Bar>
	</customHeader>
	<content>
		<SplitContainer
		id="SplitContainer"
		initialMaster="master"
		initialDetail="all">
			<masterPages>
				<Page id="master">
					<customHeader>
					<Toolbar>
						<Title text="Produkty z baselinkera" />
						<ToolbarSpacer />
					</Toolbar>
				</customHeader>
					<List  growing="true"  growingThreshold="50" growingScrollToLoad="true" sticky="HeaderToolbar" id="leftTable" items="{productsModel>/products}">
					<headerToolbar>
					<Toolbar>	
						<SearchField liveChange="onSearch"/>
					</Toolbar>
					
					</headerToolbar>
				<items>
					<StandardListItem icon="{productsModel>imageUrl}" wrapping="true" title="{productsModel>name}"/>
				</items>
				<dragDropConfig>
					<dnd:DragInfo sourceAggregation="items"/>
				</dragDropConfig>
				
			</List>
				</Page>
			</masterPages>
			<detailPages>
				<Page id="all">
				<headerContent>
					<Button text="Zmiana cen" press="navToPrices"/>
				</headerContent>
				<Table growing="true" growingThreshold="50" growingScrollToLoad="true" selectionChange="onMainTableSelectionChange" sticky="HeaderToolbar" id="rightTable" items="{productsModel>/catalogProducts}"
					>
					<headerToolbar>
					<Toolbar>
						<SearchField liveChange="onSearchCatalog"/>
						<ToolbarSpacer />				
				<Button press="onAddToPriceChange" type="Emphasized" text="Dodaj sparowane do zmieniania cen" enabled="{viewModel>/addToChangePriceEnabled}"/>
						</Toolbar>
				</headerToolbar>
				<columns>
					<Column width="10%" hAlign="Center"/>
					<Column width="5%" hAlign="Center">
						<Title text="Kod" />
					</Column>
					<Column width="25%" hAlign="Center">
						<Title text="Nazwa" />
					</Column>
					<Column width="10%" hAlign="Center">
						<Title text="Cena katalogowa" />
					</Column>
					<Column width="10%" hAlign="Center">
						<Title text="Zniżka" />
					</Column>
					<Column width="10%" hAlign="Center">
						<Title text="Cena zakupu" />
					</Column>
					<Column width="30%" hAlign="Center">
						<Title text="Promocja" />
					</Column>
					
				</columns>
				<items>
					<ColumnListItem  highlight="{productsModel>highlight}">
						<cells>
							<Image src="{productsModel>imageUrl}" height="70px" width="70px"/>
							<Text text="{productsModel>sku}" />
							<Text text="{productsModel>name}" />
							<Input value="{productsModel>price}" change="onPriceOrDiscountChange" valueStateText="Błędna cena" valueState="{productsModel>priceState}"/>
							<Select items="{viewModel>/discounts}" change="onPriceOrDiscountChange" selectedKey="{productsModel>discount}">
								<core:Item key="{viewModel>key}" text="{viewModel>value}" />
							</Select>
							<Text text="{productsModel>finalPrice}" />
							<Text text="{productsModel>promotion}" />
						</cells>
					</ColumnListItem>
				</items>
				<dragDropConfig>
						<dnd:DropInfo dropEffect="Move" drop="onPairProduct" targetAggregation="items" dropPosition="On" dropLayout="Vertical"/>
					</dragDropConfig>
			</Table>
				</Page>
				<!-- <Page id="catalog">
				<headerContent>
					<Button text="Wszystkie produkty" press="navToProducts"/>
					<Button text="Zmiana cen" press="navToPrices"/>
				</headerContent>
				<Table id="catalogTable" sticky="HeaderToolbar"  growing="true" growingThreshold="1000" items="{productsModel>/catalogProducts}"
					>
					<headerToolbar>
					<Toolbar>
						<SearchField liveChange="onSearchCatalog"/>
						<Button text="Sparuj z magazynem" press="onPairCatalog" />
						<Button text="Przenieś niesparowane" press="onAddAllToMaster" />						
						<Button text="Przenieś sparowane do zmiany cen" press="onMoveToChangePricesCatalog" />
					</Toolbar>
				</headerToolbar>
				<columns>
				<Column width="7%" />
					<Column width="20%" />
					<Column width="15%">
						<Title text="Nazwa w katalogu" />
					</Column>
					<Column width="15%">
						<Title text="Twoja nazwa" />
					</Column>
					<Column>
						<Title text="Kod AVON" />
					</Column>
					<Column>
						<Title text="Cena zakupu" />
					</Column>
					<Column>
						<Title text="Twoja cena" />
					</Column>
				</columns>
				<items>
					<ColumnListItem highlight="{path: 'productsModel>yourName', formatter: '.formatHighlightCatalog'}">
						<cells>
							<Button icon="sap-icon://arrow-left" press="onAddToMaster"/>
							<Image src="{productsModel>imageUrl}"  height="150px" width="150px"/>
							<Text text="{productsModel>name}" />
							<Text text="{productsModel>yourName}" />
							<Text text="{productsModel>sku}" />
							<Text text="{productsModel>price}" />
							<Text text="{productsModel>yourPrice}" />
						</cells>
					</ColumnListItem>
				</items>
			</Table>	
				</Page> -->
				<Page id="prices">
				<headerContent>
					<Button text="Wszystkie produkty" press="navToProducts"/>
				</headerContent>
				<Table id="changeTable" sticky="HeaderToolbar" mode="MultiSelect" growing="true" growingThreshold="1000" items="{productsModel>/changePriceProducts}"
					selectionChange="onChangePriceTableSelectionChange" >
					<headerToolbar>
					<Toolbar>
						<ToolbarSpacer />
						<CheckBox text="Zmień SKU" selected="{viewModel>/changeSku}" />
						<Label text="Prowizja (%)" />
						<Input type="Number" value="{viewModel>/brokeragePercent}" />
						<Label text="Marża" />
						<Input type="Number" value="{viewModel>/margin}" />
						<Switch state="{viewModel>/percentage}" customTextOn="%" customTextOff="Zł" />							
						<Button type="Emphasized" text="Wylicz ceny" press="countPrices"  enabled="{viewModel>/changePriceEnabled}"/>
						<Button type="Accept" text="Zmień ceny w baselinkerze" press="onChangeBaselinkerPrices"  enabled="{viewModel>/changePriceEnabled}"/>
					</Toolbar>
				</headerToolbar>
				<columns>
					<Column width="20%" />
					<Column width="30%">
						<Title text="Nazwa" />
					</Column>
					<Column>
						<Title text="Aktualne SKU" />
					</Column>
					<Column>
						<Title text="Nowe SKU" />
					</Column>
					<Column>
						<Title text="Cena" />
					</Column>
					<Column>
						<Title text="Cena zakupu" />
					</Column>
					<Column>
						<Title text="Nowa cena" />
					</Column>
				</columns>
				<items>
					<ColumnListItem>
						<cells>
							<Image src="{productsModel>imageUrl}" height="150px" width="150px"/>
							<Text text="{productsModel>sku}" />
							<Text text="{productsModel>catalogSku}" />
							<Text text="{productsModel>name}" />
							<Text text="{productsModel>price}" />
							<Input type="Number" value="{productsModel>boughtPrice}" />
							<Input type="Number" value="{productsModel>newPrice}" />
						</cells>
					</ColumnListItem>
				</items>
			</Table>	
				</Page>
			</detailPages>
		</SplitContainer>
		</content>
		</Page>
</mvc:View>